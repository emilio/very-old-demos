/*! EC.js - v0.1.0 - 2013-05-15
* Copyright (c) 2013 Emilio Cobos Álvarez; Licensed MIT */
(function(e,t){"use strict";var n=0;EC.modal=EC.modal||function(e){return this.id=++n,this.options=EC.core.extend({animation:"fade",animationDuration:600,maxWidth:600,topDistance:"25%",title:t,content:t,footer:t,onclose:null,customClose:!1},e),this.elements=this._createElements(),this},EC.modal.create=function(e){return new EC.modal(e)},EC.core.extend(EC.modal.prototype,{options:{},elements:{},_createElements:function(){var e=this,n={};return n.modal=EC.DOM.create("div",{className:"ec-modal",id:"ec-modal-"+this.id,style:{display:"none",width:"90%",maxWidth:this.options.maxWidth+"px"}}).appendTo("body"),EC.core.forEach(["title","content","footer"],function(o){e.options[o]!==t&&(n["modal_"+o]=EC.DOM.create("div",{className:"ec-modal-"+o}).appendTo(n.modal).append(e.options[o]))}),n.overlay=EC.DOM.create("div",{className:"ec-modal-overlay",style:{display:"none"}}).appendTo("body"),e.options.customClose||n.overlay.on("click",function(){e.close()}),n},remove:function(){return this.elements.modal.remove(),this.elements.overlay.remove(),null},show:function(e){var t=this.elements.modal,n=this.elements.overlay;switch(t.css({visibility:"hidden",display:"block"}),this.positionModal(),t.css("visibility","visible"),n.css("display","block"),this.options.animation){case"fade":t.css("opacity","0"),n.css("opacity","0"),n.animate({opacity:1},this.options.animationDuration),t.animate({opacity:1},this.options.animationDuration,"ease",e)}(e&&"function"==typeof e&&!this.options.animation||"none"===this.options.animation)&&e()},close:function(){this.options.onclose&&"function"==typeof this.options.onclose&&this.options.onclose(),this.elements.modal.css("display","none"),this.elements.overlay.css("display","none")},positionModal:function(){var t=this.elements.modal,n=t.get(0),o=n.offsetWidth/2;t.css({position:n.offsetHeight>e.screen.height*(100-parseInt(this.options.topDistance,10))/100?"absolute":"fixed",top:this.options.topDistance,left:"50%",marginLeft:"-"+o+"px"})}})})(window);