/*! EC.js - v0.1.0 - 2013-05-07
* Copyright (c) 2013 Emilio Cobos Álvarez; Licensed MIT */
(function(e,t){"use strict";EC.DOM=EC.DOM||{};var n=function(e){for(var t=[],n=e.length;n--;t.unshift(e[n]));return t},o=function(){var e={};return function(t){return e.hasOwnProperty(t)||(e[t]=RegExp("\\b("+t+")\\b","g")),e[t]}}();EC.core.extend(EC.DOM,{select:function(e,t){return new EC.DOMInstance(e,t)},create:function(e,t){var n,o=document.createElement(e);for(n in t)t.hasOwnProperty(n)&&"style"!==n&&"attributes"!==n&&(o[n]=t[n]);if(t.style&&EC.core.extend(o.style,t.style),t.attributes)for(n in t.attributes)t.attributes.hasOwnProperty(n)&&o.setAttribute(n,t.attributes[n]);return EC.DOM.select(o)},supportsProp:function(){var t=document.createElement("_"),n={},o=["Webkit","Moz","Ms","O","webkit","moz","ms","o"],r=o.length;return function(i,a){var s,c=0;if(n[i])return n[i];if(s=a?"boolean"==typeof a?t:a:e,i in s)return n[i]=i,i;for(i=i.charAt(0).toUpperCase()+i.substring(1);r>c;c++)if(o[c]+i in s)return n[i]=o[c]+i,n[i];return!1}}(),matchesSelector:function(e,t){var n;if(n=EC.DOM.supportsProp("matchesSelector",e))return e[n](t);switch(t.substring(0,1)){case".":return o(t.substring(1)).test(e.className);case"#":return e.id===t.substring(1);default:return e.nodeName.toLowerCase()===t.toLowerCase()}},event:{add:function(n,o,r,i){var a=function(o){return o=o||e.event,o.preventDefault||(o.preventDefault=function(){o.returnValue=!1}),o.stopPropagation||(o.stopPropagation=function(){o.cancelBubble=!0}),o.target||(o.target=o.srcElement),!o.keyCode&&o.which&&(o.keyCode=o.which),r?(EC.DOM.matchesSelector(o.target,r)&&i.call(o.target,o),t):(i.call(n,o),t)};return i||(i=r,r=null),n.addEventListener?n.addEventListener(o,a,!1):n.attachEvent("on"+o,a),!0}}}),EC.DOMInstance=function(e,t){if(t&&(("string"==typeof t||t.nodeType)&&(t=new EC.DOMInstance(t)),t instanceof EC.DOMInstance))return t.find(e);if(e){if(e.nodeType)this.els=[e];else if("string"==typeof e)switch(e){case"body":this.els=[document.body];break;case"html":this.els=[document.documentElement];break;default:this.els=/^#([0-9A-Z-_])$/i.test(e)?[document.getElementById(RegExp.$1)]:n(document.querySelectorAll(e))}}else this.els=[];return this},EC.core.extend(EC.DOMInstance.prototype,{els:[],forEach:function(e){return EC.core.forEach(this.els,e),this},attr:function(e,n){var o;return n===t?(o=this.els[0])?o.getAttribute(e):null:this.forEach(function(t){t.setAttribute(e,n)})},addClass:function(e){var t=o(e);return this.forEach(function(n){t.test(n.className)||(n.className+=" "+e)})},removeClass:function(e){var t=o(e.split(" ").join("|"));return this.forEach(function(e){e.className=e.className.replace(t,"")})},hasClass:function(e){var t,n=o(e);return(t=this.els[0])?n.test(t.className):!1},get:function(e){return e!==t?this.els[e]:this.els},first:function(e){var n=this.els[0];return e===t?new EC.DOMInstance(n):new EC.DOMInstance(n.querySelector(e))},append:function(e){var t=this.els[0];if(t)return"string"==typeof e?t.innerHTML+=e:e instanceof EC.DOMInstance?e.forEach(function(e){t.appendChild(e)}):t.appendChild(e),this},appendTo:function(e){return("string"==typeof e||e.nodeType)&&(e=EC.DOM.select(e)),this.forEach(function(t){e.append(t)})},on:function(e,t,n){return this.forEach(function(o){EC.DOM.event.add(o,e,t,n)})},find:function(e){var t=[],o=new EC.DOMInstance;return this.forEach(function(o){t=t.concat(n(o.querySelectorAll(e)))}),o.els=t,o},css:function(e,n){return n!==t?this.forEach(function(t){t.style[e]=n}):this.forEach(function(t){var n;for(n in e)e.hasOwnProperty(n)&&(t.style[n]=e[n])})},remove:function(){return this.forEach(function(e){e.parentNode&&e.parentNode.removeChild(e)})},animate:function(){var e,t=EC.DOM.supportsProp("transition",document.documentElement.style),n={transition:"transitionend",OTransition:"oTransitionEnd",MozTransition:"transitionend",WebkitTransition:"webkitTransitionEnd"};return t===!1?function(e,t,n,o){return this.css(e),o&&"function"==typeof o?this.forEach(function(e){o.call(e)}):this}:(e=n[t],function(n,o,r,i){var a,s=[];if(!this.els[0])return this;o||(o=600),r||(r="ease"),o/=1e3;for(a in n)n.hasOwnProperty(a)&&s.push(a+" "+o+"s "+r);return s=s.join(","),i&&"function"==typeof i&&this.forEach(function(t){t.addEventListener(e,function n(o){i.call(t,o),t.removeEventListener(e,n)},!1)}),this.forEach(function(e){e.style[t]=s}),this.els[0].offsetWidth,this.css(n)})}()}),"function"!=typeof e.$&&(e.$=EC.DOM.select),document.querySelectorAll||function(){var t=document.documentElement.firstChild,n=document.createElement("style");t.appendChild(n),document.querySelectorAll=function(t){return document.__qsaels=[],n.styleSheet.cssText=t+"{x:expression(document.__qsaels.push(this))}",e.scrollBy(0,0),document.__qsaels}}(),document.querySelector||(document.querySelector=function(e){return document.querySelectorAll(e)[0]||null})})(window),function(e,t){var n=e.document,o=e.EC=e.EC||{baseScriptPath:function(){var e=n.scripts[n.scripts.length-1];return e.src?e.src.replace(/[a-z\.A-Z0-9]+\.js$/,""):null}()},r=n.getElementsByTagName("script")[0],i={};o.core=o.core||{},o.core.extend=function(e,t){var n;for(n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e},o.core.extend(o.core,{loaded:function(e){var n;for(e=e.split("/"),n=e.length;n--;)if(o[e[n]]===t)return!1;return!0},require:function(e,n){var r,i=function(e){return o.baseScriptPath+"ec."+e.replace(/\//g,"_").toLowerCase()+".js"};"string"==typeof e&&(e=[e]),r=function(){for(var t=e.length,r=0;t>r;r++)if(!o.core.loaded(e[r]))return;n&&"function"==typeof n&&n()},o.core.forEach(e,function(e){var n;return o.core.loaded(e)?r():(n=i(e),o.core.loadJS(n,r),t)})},loadJS:function(e,t){var o,i=n.createElement("script");i.async=!0,i.onload=i.onreadystatechange=function(){o||i.readyState&&"complete"!==i.readyState&&"loaded"!==i.readyState||(o=!0,t&&"function"==typeof t&&t.call(null,i))},i.src=e,r.parentNode.insertBefore(i,r)},loadCSS:function(e,o,a){var s=n.createElement("link");return a!==t?s.id=a:a=e,a in i?i[a]:(s.href=e,s.rel="stylesheet",s.type="text/css",i[a]=s,r.parentNode.insertBefore(s,r),setTimeout(o,0),t)},forEach:function(e,t){for(var n=0,o=e.length;o>n;n++)t.call(e[n],e[n],n);return!0},parseJSON:function(t){return e.JSON&&e.JSON.parse?e.JSON.parse(t):Function("return "+t)()},htmlEscape:function(e){return e.replace(/&|<|>/g,function(e){return{"&":"&amp;","<":"&lt;",">":"&gt;"}[e]})},isArray:Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)}}),o.require=o.core.require}(window),function(e,t){"use strict";var n=0;EC.modal=EC.modal||function(e){return this.id=++n,this.options=EC.core.extend({animation:"fade",animationDuration:600,maxWidth:600,topDistance:"25%",title:t,content:t,footer:t,customClose:!1},e),this.elements=this._createElements(),this},EC.modal.create=function(e){return new EC.modal(e)},EC.core.extend(EC.modal.prototype,{options:{},elements:{},_createElements:function(){var e=this,n={};return n.modal=EC.DOM.create("div",{className:"ec-modal",id:"ec-modal-"+this.id,style:{display:"none",width:"90%",maxWidth:this.options.maxWidth+"px"}}).appendTo("body"),EC.core.forEach(["title","content","footer"],function(o){e.options[o]!==t&&(n["modal_"+o]=EC.DOM.create("div",{className:"ec-modal-"+o}).appendTo(n.modal).append(e.options[o]))}),n.overlay=EC.DOM.create("div",{className:"ec-modal-overlay",style:{display:"none"}}).appendTo("body"),e.options.customClose||n.overlay.on("click",function(){e.close()}),n},remove:function(){return this.elements.modal.remove(),this.elements.overlay.remove(),null},show:function(e){var t=this.elements.modal,n=this.elements.overlay;switch(t.css({visibility:"hidden",display:"block"}),this.positionModal(),t.css("visibility","visible"),n.css("display","block"),this.options.animation){case"fade":t.css("opacity","0"),n.css("opacity","0"),n.animate({opacity:1},this.options.animationDuration),t.animate({opacity:1},this.options.animationDuration,"ease",e)}(e&&"function"==typeof e&&!this.options.animation||"none"===this.options.animation)&&e()},close:function(){this.elements.modal.css("display","none"),this.elements.overlay.css("display","none")},positionModal:function(){var t=this.elements.modal,n=t.get(0),o=n.offsetWidth/2;t.css({position:n.offsetHeight>e.screen.height*(100-parseInt(this.options.topDistance,10))/100?"absolute":"fixed",top:this.options.topDistance,left:"50%",marginLeft:"-"+o+"px"})}})}(window),function(e){"use strict";EC.notification=EC.notification||{};var t=0;EC.core.extend(EC.notification,{nativeSupport:!!e.Notification,create:function(t,n){return EC.notification.nativeSupport?new e.Notification(t,n||{}):EC.DOM?new EC.notification.DOMBasedNotification(t,n):undefined},DOMBasedNotification:function(e,n){var o,r=this;return n=r.options=n||{},o=r.element=EC.DOM.create("div",{className:"ec-dom-notification",innerHTML:function(){var t='<div class="ec-dom-notification-close">&times;</div><h2 class="ec-dom-notification-title">'+e+"</h2>";return n.iconUrl&&(t+='<img class="ec-dom-notification-icon" src="'+n.iconUrl+'" alt>'),n.body&&(t+='<div class="ec-dom-notification-body">'+EC.core.htmlEscape(n.body)+"</div>"),t}(),id:"ec-dom-notification-"+ ++t}),"function"==typeof n.onclick&&o.on("click",n.onclick),o.first(".ec-dom-notification-close").on("click",function(){r.close()}),r}}),EC.core.extend(EC.notification.DOMBasedNotification.prototype,{show:function(){this.element.appendTo("body"),"function"==typeof this.options.onshow&&this.options.onshow.call(this)},close:function(){this.element.addClass("is-hidden"),"function"==typeof this.options.onclose&&this.options.onclose.call(this)}})}(window),function(e,t){"use strict";EC.request=EC.request||function(e){var t;return e=EC.core.extend({method:"GET",url:"",requestContentType:null,data:null,jsonpCallbackField:"callback",processData:!0,onsuccess:null,onerror:null,async:!0,type:null,context:null},e),"jsonp"===e.type?EC.request.jsonp(e):(t=EC.request.create(),"GET"===e.method&&e.data&&(e.url+=(e.url.indexOf("?")>-1?"&":"?")+EC.request.generateQuery(e.data),e.data=null),t.open(e.method,e.url,e.async),e.requestContentType&&t.setRequestHeader&&t.setRequestHeader("Content-Type",e.requestContentType),t.onreadystatechange=function(){var n;4===t.readyState&&(200===t.status?(n="json"===e.type?EC.core.parseJSON(t.responseText):"xml"===e.type?t.responseXML:t.responseText,e.onsuccess&&"function"==typeof e.onsuccess&&e.onsuccess.call(e.context,n,t)):e.onerror&&"function"==typeof e.onerror&&e.onerror.call(e.context,n,t))},e.processData&&e.data&&(e.data=EC.request.generateQuery(e.data)),t.send(e.data),!0)},EC.core.extend(EC.request,{create:function(){return e.XMLHttpRequest?new e.XMLHttpRequest:new e.ActiveXObject("Microsoft.XMLHTTP")},generateQuery:function(t){var n,o=null;if("string"==typeof t||e.FormData&&t instanceof e.FormData)return t;for(n in t)t.hasOwnProperty(n)&&(o=null===o?n+"="+encodeURIComponent(t[n]):"&"+n+"="+encodeURIComponent(t[n]));return o},jsonp:function(n){var o,r="ec_"+ +new Date;return n.data=n.data||{},n.data[n.jsonpCallbackField]=r,e[r]=function(o){n.onsuccess&&"function"==typeof n.onsuccess&&n.onsuccess.call(n.context,o),e[r]=t},o=n.url+(n.url.indexOf("?")>-1?"&":"?")+EC.request.generateQuery(n.data),EC.core.loadJS(o,function(e){e.parentNode.removeChild(e)},n.onerror),!0},get:function(e,t){return EC.request({url:e,method:"GET",onsuccess:t})},post:function(e,t,n){return"string"==typeof e?EC.request({url:e,method:"POST",onsuccess:n,data:t}):EC.request(EC.core.extend({method:"POST"},e))}})}(window),function(){"use strict";EC.UI=EC.UI||{};var e=!1,t=function(){EC.UI.modal=EC.modal.create({title:"",content:"",footer:"",customClose:!0}),EC.UI.modal.elements.modal.addClass("ec-ui-modal"),e=!0};EC.core.extend(EC.UI,{language:"en_EN",messages:{en_EN:{ok:"Ok",accept:"Ok",cancel:"Cancel",yes:"Yes",no:"No",alert:"Alert",confirm:"Confirm your action",prompt:"Prompt dialog"},es_ES:{ok:"Ok",accept:"Aceptar",cancel:"Cancelar",yes:"Sí",no:"No",alert:"Alerta",confirm:"Confirma tu acción",prompt:"Diálogo para ingresar información"}},modal:null,getLanguage:function(){return EC.UI.messages[EC.UI.language]},alert:function(n,o){var r,i=EC.UI.getLanguage();e||t(),o||(o=i.alert),EC.UI.modal.elements.modal_title.get(0).innerHTML=o,EC.UI.modal.elements.modal_content.get(0).innerHTML=n,EC.UI.modal.elements.modal_footer.get(0).innerHTML="",EC.UI.modal.elements.modal_footer.append(r=EC.DOM.create("button",{className:"ec-ui-btn ec-ui-btn-ok",innerHTML:i.ok,onclick:function(){EC.UI.modal.close()}})),EC.UI.modal.show(function(){r.get(0).focus()})},confirm:function(n,o,r){var i,a=EC.UI.getLanguage();e||t(),r||(r=a.confirm),EC.UI.modal.elements.modal_title.get(0).innerHTML=r,EC.UI.modal.elements.modal_content.get(0).innerHTML=n,EC.UI.modal.elements.modal_footer.get(0).innerHTML="",EC.UI.modal.elements.modal_footer.append(EC.DOM.create("button",{className:"ec-ui-btn ec-ui-btn-cancel",innerHTML:a.cancel,onclick:function(){EC.UI.modal.close(),o(!1)}})).append(i=EC.DOM.create("button",{className:"ec-ui-btn ec-ui-btn-ok",innerHTML:a.accept,onclick:function(){EC.UI.modal.close(),o(!0)}})),EC.UI.modal.show(function(){i.get(0).focus()})},prompt:function(n,o,r,i){var a=EC.UI.getLanguage(),s=EC.DOM.create("input",{className:"ec-ui-input",type:"text",value:r||""});e||t(),i||(i=a.prompt),EC.UI.modal.elements.modal_title.get(0).innerHTML=i,EC.UI.modal.elements.modal_content.get(0).innerHTML=n,EC.UI.modal.elements.modal_content.append(EC.DOM.create("div",{className:"ec-ui-input-wrapper"}).append(s)),EC.UI.modal.elements.modal_footer.get(0).innerHTML="",EC.UI.modal.elements.modal_footer.append(EC.DOM.create("button",{className:"ec-ui-btn ec-ui-btn-ok",innerHTML:a.ok,onclick:function(){EC.UI.modal.close(),o(s.get(0).value)}})),EC.UI.modal.show(function(){s.get(0).focus(),s.get(0).select()})}})}(window);